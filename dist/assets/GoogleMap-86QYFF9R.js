import{r as a,L as P,c,I as C,l as R}from"./index-ieA05vuE.js";const j=({center:d,zoom:y,onMapClick:i,selectedLocation:r,onRadiusChange:p,height:I="400px",width:w="100%"})=>{const m=a.useRef(null),x=a.useRef(null),[s,v]=a.useState(null),[h,b]=a.useState(null),[g,S]=a.useState(null),[u,E]=a.useState(!1);return a.useEffect(()=>{const l="AIzaSyB8B04MTIk7abJDVESr6SUF6f3Hgt1DPAY";new P({apiKey:l,version:"weekly",libraries:["places"],region:"ID",language:"id"}).load().then(async()=>{if(m.current&&!s){const e=new google.maps.Map(m.current,{center:{lat:d[0],lng:d[1]},zoom:y,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER}});if(v(e),E(!0),i&&e.addListener("click",t=>{if(t.latLng){const o=t.latLng.lat(),f=t.latLng.lng();i(o,f)}}),x.current?.input){const t=new google.maps.places.Autocomplete(x.current.input,{types:["geocode","establishment"],fields:["geometry","name","formatted_address"],componentRestrictions:{country:"id"}});t.addListener("place_changed",()=>{const o=t.getPlace();o.geometry?.location&&(e.setCenter(o.geometry.location),e.setZoom(15),i&&i(o.geometry.location.lat(),o.geometry.location.lng()))})}}}).catch(e=>{console.error("Google Maps API failed to load:",e)})},[d,y,i,s]),a.useEffect(()=>{if(!s||!u||!r)return;h&&h.setMap(null),g&&g.setMap(null);const l=new google.maps.Marker({position:{lat:r.lat,lng:r.lng},map:s,draggable:!0,title:"Lokasi Presensi"});i&&l.addListener("dragend",()=>{const e=l.getPosition();e&&i(e.lat(),e.lng())}),b(l);const n=new google.maps.Circle({strokeColor:"#1890ff",strokeOpacity:.8,strokeWeight:2,fillColor:"#1890ff",fillOpacity:.2,map:s,center:{lat:r.lat,lng:r.lng},radius:r.range,editable:!0});return p&&n.addListener("radius_changed",()=>{p(n.getRadius())}),S(n),s.setCenter({lat:r.lat,lng:r.lng}),()=>{l&&l.setMap(null),n&&n.setMap(null)}},[s,u,r,i,p]),a.useEffect(()=>{if(!s||!u||!r||!p)return;const l=s.controls[google.maps.ControlPosition.TOP_RIGHT];for(let t=0;t<l.getLength();t++){const o=l.getAt(t);if(o&&o.className==="radius-control"){l.removeAt(t);break}}const n=document.createElement("div");n.className="radius-control",s.controls[google.maps.ControlPosition.TOP_RIGHT].push(n);const e=n.querySelector("input");e&&e.addEventListener("input",t=>{const o=parseInt(t.target.value);g&&g.setRadius(o),p(o);const f=n.querySelector("span:nth-child(2)");f&&(f.textContent=`${o}m`)})},[s,u,r,p,g]),c.jsxs("div",{style:{position:"relative",width:w,height:I},children:[c.jsx("div",{style:{position:"absolute",top:"16px",left:"16px",zIndex:10,width:"256px"},children:c.jsx("div",{style:{position:"relative"},children:c.jsx(C,{ref:x,placeholder:"Cari lokasi...",prefix:c.jsx(R,{}),style:{width:"100%",backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)"}})})}),c.jsx("div",{ref:m,style:{width:"100%",height:"100%"}})]})};export{j as default};
